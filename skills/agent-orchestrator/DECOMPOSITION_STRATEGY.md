# Agent Orchestrator - ä»»åŠ¡åˆ†è§£ç­–ç•¥è¯¦è§£

## ğŸ“‹ æ¦‚è¿°

Agent Orchestrator é€šè¿‡æ™ºèƒ½å…³é”®è¯åŒ¹é…ï¼Œå°†å¤æ‚çš„ç”¨æˆ·è¯·æ±‚åˆ†è§£ä¸ºå¤šä¸ªèƒ½åŠ›ç‰¹å®šçš„å­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡ç”±ä¸“é—¨èƒ½åŠ›çš„ agent æ‰§è¡Œã€‚

## ğŸ” èƒ½åŠ›è¯†åˆ«ç³»ç»Ÿ

### å…­å¤§æ ¸å¿ƒèƒ½åŠ›

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Research   â”‚   Coding    â”‚   Testing   â”‚    Docs     â”‚     Ops     â”‚    Image    â”‚
â”‚   è°ƒç ”åˆ†æ   â”‚   å¼€å‘å®ç°   â”‚   æµ‹è¯•éªŒè¯   â”‚   æ–‡æ¡£ç¼–å†™   â”‚   è¿ç»´éƒ¨ç½²   â”‚   è®¾è®¡ç»˜å›¾   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è¯æ˜ å°„è¡¨

| èƒ½åŠ› | è‹±æ–‡å…³é”®è¯ | ä¸­æ–‡å…³é”®è¯ |
|-----|-----------|-----------|
| **research** | research, analy, find, collect | åˆ†æ, è°ƒç ”, èµ„æ–™, æŸ¥æ‰¾, æ”¶é›†, æ•´ç† |
| **coding** | code, implement, refactor, fix | å¼€å‘, å®ç°, é‡æ„, ä¿®å¤, è„šæœ¬, ç¼–å†™, ç¼–ç¨‹ |
| **testing** | test, pytest, coverage | æµ‹è¯•, ç”¨ä¾‹, è¦†ç›–ç‡, å›å½’, éªŒè¯ |
| **docs** | doc, readme, documentation | æ–‡æ¡£, è¯´æ˜, æ€»ç»“, å†™æ–‡æ¡£ |
| **ops** | deploy, monitor, ops | ä¸Šçº¿, ç›‘æ§, å‘Šè­¦, è¿ç»´, éƒ¨ç½² |
| **image** | image, poster, design | å›¾, æµ·æŠ¥, ç»˜å›¾, è®¾è®¡ |

## ğŸ¯ ä»»åŠ¡åˆ†è§£æµç¨‹

```mermaid
flowchart TD
    A[ç”¨æˆ·è¯·æ±‚] --> B{æå–èƒ½åŠ›å…³é”®è¯}
    B --> C[è¯†åˆ«èƒ½åŠ›ç±»å‹]
    C --> D[æå–æ ¸å¿ƒä¸»é¢˜]
    D --> E[æ¸…ç†å†—ä½™è¯æ±‡]
    E --> F[åº”ç”¨ä»»åŠ¡æ¨¡æ¿]
    F --> G[æŒ‰é¡ºåºæ’åˆ—ä»»åŠ¡]
    G --> H[è®¾ç½®ä»»åŠ¡ä¾èµ–]
    H --> I[ç”Ÿæˆæœ€ç»ˆä»»åŠ¡åˆ—è¡¨]
    
    B -->|æ— åŒ¹é…| J[é»˜è®¤: coding]
    J --> D
```

### è¯¦ç»†æ­¥éª¤

1. **æå–èƒ½åŠ›** (`_extract_capabilities`)
   ```python
   è¾“å…¥: "ç¼–å†™ç¨‹åºè·å– HN æœ€æ–° 30 æ¡ è¿›è¡Œæµ‹è¯• å®Œæˆ ä½¿ç”¨æ–‡æ¡£ç¼–å†™"
   å¤„ç†: æ‰«æå…³é”®è¯ â†’ åŒ¹é…èƒ½åŠ›
   è¾“å‡º: ['coding', 'testing', 'docs']
   ```

2. **æå–ä¸»é¢˜** (`_extract_topic`)
   ```python
   è¾“å…¥: "ç¼–å†™ç¨‹åºè·å– HN æœ€æ–° 30 æ¡ è¿›è¡Œæµ‹è¯•"
   å¤„ç†: ç§»é™¤èƒ½åŠ›å…³é”®è¯ â†’ æ¸…ç†æ ‡ç‚¹
   è¾“å‡º: "è·å– HN æœ€æ–° 30 æ¡"
   ```

3. **ç”Ÿæˆä»»åŠ¡** (`_decompose_request`)
   ```python
   è¾“å…¥: èƒ½åŠ›åˆ—è¡¨ + ä¸»é¢˜
   å¤„ç†: ä¸ºæ¯ä¸ªèƒ½åŠ›åº”ç”¨æ¨¡æ¿
   è¾“å‡º: 
   - [coding] å®ç°/å¼€å‘ï¼šè·å– HN æœ€æ–° 30 æ¡
   - [testing] æµ‹è¯•éªŒè¯ï¼š...ï¼ˆåŒ…æ‹¬åŠŸèƒ½æµ‹è¯•ã€è¾¹ç•Œæ¡ä»¶ã€é”™è¯¯å¤„ç†ï¼‰
   - [docs] ç¼–å†™ä½¿ç”¨æ–‡æ¡£ï¼š...ï¼ˆåŒ…æ‹¬å®‰è£…ã€é…ç½®ã€ä½¿ç”¨ç¤ºä¾‹ï¼‰
   ```

4. **ä»»åŠ¡æ’åº**
   ```python
   æ ‡å‡†é¡ºåº: research â†’ coding â†’ testing â†’ docs â†’ ops â†’ image
   ```

## ğŸ“ ä»»åŠ¡æ¨¡æ¿ç³»ç»Ÿ

### æ¨¡æ¿å®šä¹‰

```python
CAPABILITY_TASK_TEMPLATES = {
    "research": "è¿›è¡Œèµ„æ–™è°ƒç ”ä¸åˆ†æï¼š{topic}",
    "coding": "å®ç°/å¼€å‘ï¼š{topic}",
    "testing": "æµ‹è¯•éªŒè¯ï¼š{topic}ï¼ˆåŒ…æ‹¬åŠŸèƒ½æµ‹è¯•ã€è¾¹ç•Œæ¡ä»¶ã€é”™è¯¯å¤„ç†ï¼‰",
    "docs": "ç¼–å†™ä½¿ç”¨æ–‡æ¡£ï¼š{topic}ï¼ˆåŒ…æ‹¬å®‰è£…ã€é…ç½®ã€ä½¿ç”¨ç¤ºä¾‹ï¼‰",
    "ops": "è¿ç»´éƒ¨ç½²ï¼š{topic}",
    "image": "è®¾è®¡/ç»˜å›¾ï¼š{topic}",
}
```

### æ¨¡æ¿åº”ç”¨ç¤ºä¾‹

**è¯·æ±‚**: "å¼€å‘ç”¨æˆ·è®¤è¯æ¨¡å—"

| èƒ½åŠ› | æ¨¡æ¿ | ç”Ÿæˆä»»åŠ¡ |
|-----|------|---------|
| coding | `å®ç°/å¼€å‘ï¼š{topic}` | å®ç°ç”¨æˆ·è®¤è¯æ¨¡å— |
| testing | `æµ‹è¯•éªŒè¯ï¼š{topic}ï¼ˆåŒ…æ‹¬...ï¼‰` | æµ‹è¯•éªŒè¯ï¼šç”¨æˆ·è®¤è¯æ¨¡å—ï¼ˆåŒ…æ‹¬åŠŸèƒ½æµ‹è¯•ã€è¾¹ç•Œæ¡ä»¶ã€é”™è¯¯å¤„ç†ï¼‰ |
| docs | `ç¼–å†™ä½¿ç”¨æ–‡æ¡£ï¼š{topic}ï¼ˆåŒ…æ‹¬...ï¼‰` | ç¼–å†™ä½¿ç”¨æ–‡æ¡£ï¼šç”¨æˆ·è®¤è¯æ¨¡å—ï¼ˆåŒ…æ‹¬å®‰è£…ã€é…ç½®ã€ä½¿ç”¨ç¤ºä¾‹ï¼‰ |

## ğŸ§ª å®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹ 1: å•èƒ½åŠ›ä»»åŠ¡

```bash
è¯·æ±‚: "è®¿é—®moltç½‘ç«™è·å–æœ€ç«çƒ­å¸–å­çš„å†…å®¹å’Œè®¨è®ºä¿¡æ¯ï¼Œåˆ†ææ•´ç†åç”Ÿæˆä¸€ç¯‡æŠ€æœ¯åšå®¢æ–‡ç« "

åˆ†è§£è¿‡ç¨‹:
1. å…³é”®è¯åŒ¹é…: "åˆ†æ" â†’ research
2. æå–ä¸»é¢˜: "è®¿é—®moltç½‘ç«™è·å–æœ€ç«çƒ­å¸–å­çš„å†…å®¹å’Œè®¨è®ºä¿¡æ¯ï¼Œç”ŸæˆæŠ€æœ¯åšå®¢æ–‡ç« "
3. åº”ç”¨æ¨¡æ¿: "è¿›è¡Œèµ„æ–™è°ƒç ”ä¸åˆ†æï¼š{ä¸»é¢˜}"

ç»“æœ:
âœ… Task 1: [research] è¿›è¡Œèµ„æ–™è°ƒç ”ä¸åˆ†æï¼šè®¿é—®moltç½‘ç«™è·å–æœ€ç«çƒ­å¸–å­çš„å†…å®¹å’Œè®¨è®ºä¿¡æ¯ï¼Œåˆ†ææ•´ç†åç”Ÿæˆä¸€ç¯‡æŠ€æœ¯åšå®¢æ–‡ç« 
```

### æ¡ˆä¾‹ 2: å¤šèƒ½åŠ›æµæ°´çº¿

```bash
è¯·æ±‚: "ç¼–å†™ç¨‹åºè·å– Hacker News æœ€æ–° 30 æ¡ä¿¡æ¯ è¿›è¡Œæµ‹è¯• å®Œæˆ ä½¿ç”¨æ–‡æ¡£ç¼–å†™"

åˆ†è§£è¿‡ç¨‹:
1. å…³é”®è¯åŒ¹é…: "ç¼–å†™ç¨‹åº" â†’ coding, "æµ‹è¯•" â†’ testing, "æ–‡æ¡£" â†’ docs
2. è¯†åˆ«èƒ½åŠ›: ['coding', 'testing', 'docs']
3. ä¸ºæ¯ä¸ªèƒ½åŠ›ç”Ÿæˆç‹¬ç«‹ä»»åŠ¡

ç»“æœ:
âœ… Task 1: [coding] ç¼–å†™ç¨‹åºè·å– Hacker News æœ€æ–° 30 æ¡ä¿¡æ¯
âœ… Task 2: [testing] æµ‹è¯•éªŒè¯ï¼š...ï¼ˆåŒ…æ‹¬åŠŸèƒ½æµ‹è¯•ã€è¾¹ç•Œæ¡ä»¶ã€é”™è¯¯å¤„ç†ï¼‰
âœ… Task 3: [docs] ç¼–å†™ä½¿ç”¨æ–‡æ¡£ï¼š...ï¼ˆåŒ…æ‹¬å®‰è£…ã€é…ç½®ã€ä½¿ç”¨ç¤ºä¾‹ï¼‰
```

### æ¡ˆä¾‹ 3: è¿ç»´ä»»åŠ¡

```bash
è¯·æ±‚: "éƒ¨ç½²åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œé…ç½®ç›‘æ§å‘Šè­¦"

åˆ†è§£è¿‡ç¨‹:
1. å…³é”®è¯åŒ¹é…: "éƒ¨ç½²" â†’ ops, "ç›‘æ§" â†’ ops
2. å»é‡: ['ops']
3. åº”ç”¨æ¨¡æ¿

ç»“æœ:
âœ… Task 1: [ops] è¿ç»´éƒ¨ç½²ï¼šéƒ¨ç½²åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œé…ç½®ç›‘æ§å‘Šè­¦
```

### æ¡ˆä¾‹ 4: é»˜è®¤è¡Œä¸º

```bash
è¯·æ±‚: "å¸®æˆ‘å¤„ç†è¿™ä¸ªæ•°æ®"

åˆ†è§£è¿‡ç¨‹:
1. å…³é”®è¯åŒ¹é…: æ— åŒ¹é…
2. é»˜è®¤èƒ½åŠ›: ['coding']
3. åº”ç”¨æ¨¡æ¿

ç»“æœ:
âœ… Task 1: [coding] å®ç°åŠŸèƒ½
```

## ğŸ”§ æ™ºèƒ½ç‰¹æ€§

### è‡ªåŠ¨æ¸…ç†

ç³»ç»Ÿä¼šè‡ªåŠ¨æ¸…ç†ä»»åŠ¡æè¿°ä¸­çš„å†—ä½™ä¿¡æ¯ï¼š

```python
åŸå§‹: "ç¼–å†™ç¨‹åºè·å– HN æœ€æ–° 30 æ¡ è¿›è¡Œæµ‹è¯• å®Œæˆ ä½¿ç”¨æ–‡æ¡£ç¼–å†™"
æ¸…ç†: "è·å– HN æœ€æ–° 30 æ¡"

æ¸…ç†è§„åˆ™:
- ç§»é™¤èƒ½åŠ›å…³é”®è¯
- ç§»é™¤æ ‡ç‚¹ç¬¦å·ï¼ˆ,ï¼Œã€ï¼›;å’Œä¸åŠï¼‰
- ç§»é™¤è¿æ¥è¯ï¼ˆç„¶åã€å†ã€æ¥ç€ã€ä¹‹åï¼‰
- å‹ç¼©ç©ºç™½å­—ç¬¦
```

### Coding ä»»åŠ¡ç‰¹æ®Šå¤„ç†

å¯¹äº coding ä»»åŠ¡ï¼Œç³»ç»Ÿä¼šç§»é™¤ testing å’Œ docs ç›¸å…³çš„æè¿°ï¼š

```python
åŸå§‹: "å¼€å‘ç”¨æˆ·è®¤è¯æ¨¡å—ï¼Œè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œç¼–å†™APIæ–‡æ¡£"
â†’ [coding] å¼€å‘ç”¨æˆ·è®¤è¯æ¨¡å—  # åªä¿ç•™å¼€å‘éƒ¨åˆ†
```

## ğŸ“Š ä»»åŠ¡ä¾èµ–æ¨¡å¼

### Single æ¨¡å¼
```
æ‰€æœ‰ä»»åŠ¡ â†’ åˆå¹¶ä¸º 1 ä¸ª â†’ ç”±å•ä¸ª agent å®Œæˆ
```

### Linear æ¨¡å¼
```
Task 1 â†’ Task 2 â†’ Task 3 â†’ Task N
é¡ºåºæ‰§è¡Œï¼Œæ¯ä¸ªä»»åŠ¡ä¾èµ–å‰ä¸€ä¸ª
```

### DAG æ¨¡å¼
```
æ”¯æŒå¤æ‚çš„ä¾èµ–å…³ç³»å›¾
Task 1 â”€â”€â”¬â”€â”€â†’ Task 3
         â”‚
Task 2 â”€â”€â”´â”€â”€â†’ Task 4
```

### Debate æ¨¡å¼
```
å¤šä¸ª agents å¹¶è¡Œè®¨è®ºå’Œè¯„å®¡
â”Œâ”€â”€â†’ Agent A â”€â”€â”
â”‚              â”‚
â”œâ”€â”€â†’ Agent B â”€â”€â”¼â”€â”€â†’ æ±‡æ€»ç»“æœ
â”‚              â”‚
â””â”€â”€â†’ Agent C â”€â”€â”˜
```

## ğŸ¨ æœ€ä½³å®è·µ

### 1. æ˜ç¡®çš„èƒ½åŠ›å…³é”®è¯

âœ… **æ¨è**ï¼š
```
"å¼€å‘ç”¨æˆ·è®¤è¯æ¨¡å—ï¼Œè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œç¼–å†™APIæ–‡æ¡£"
â†’ æ˜ç¡®è¯†åˆ« coding + testing + docs
```

âŒ **ä¸æ¨è**ï¼š
```
"åšä¸ªè®¤è¯"
â†’ å¤ªæ¨¡ç³Šï¼Œåªèƒ½é»˜è®¤ä¸º coding
```

### 2. åˆç†çš„ä»»åŠ¡ç²’åº¦

âœ… **æ¨è**ï¼š
```
"å¼€å‘è®¤è¯æ¨¡å—ï¼Œæµ‹è¯•è¦†ç›–ç‡>80%"
â†’ ç²’åº¦é€‚ä¸­ï¼Œä»»åŠ¡æ¸…æ™°
```

âŒ **ä¸æ¨è**ï¼š
```
"å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²æ•´ä¸ªç³»ç»Ÿ"
â†’ ç²’åº¦å¤ªç²—ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†è§£
```

### 3. ä¸»é¢˜æè¿°æ¸…æ™°

âœ… **æ¨è**ï¼š
```
"è·å– Hacker News æœ€æ–° 30 æ¡æ–°é—»"
â†’ ä¸»é¢˜æ¸…æ™°æ˜ç¡®
```

âŒ **ä¸æ¨è**ï¼š
```
"æŠ“æ•°æ®"
â†’ ä¸»é¢˜ä¸æ˜ç¡®
```

## ğŸ“ˆ ç»Ÿè®¡ä¸ä¼˜åŒ–

### åˆ†è§£æ•ˆç‡

- **å•èƒ½åŠ›ä»»åŠ¡**: 1 ä¸ªä»»åŠ¡
- **åŒèƒ½åŠ›ä»»åŠ¡**: 2 ä¸ªä»»åŠ¡
- **ä¸‰èƒ½åŠ›ä»»åŠ¡**: 3 ä¸ªä»»åŠ¡ï¼ˆæœ€å¸¸è§ï¼šcoding+testing+docsï¼‰
- **å…¨æµç¨‹ä»»åŠ¡**: æœ€å¤š 6 ä¸ªä»»åŠ¡ï¼ˆ6 ç§èƒ½åŠ›ï¼‰

### å¸¸è§æ¨¡å¼

| æ¨¡å¼ | é¢‘ç‡ | ç¤ºä¾‹ |
|-----|------|------|
| coding | 40% | "å®ç°XXåŠŸèƒ½" |
| coding+testing+docs | 30% | "å¼€å‘XXï¼Œæµ‹è¯•ï¼Œå†™æ–‡æ¡£" |
| research | 15% | "è°ƒç ”XXï¼Œåˆ†æXX" |
| ops | 10% | "éƒ¨ç½²XXï¼Œé…ç½®ç›‘æ§" |
| å…¶ä»– | 5% | image, è‡ªå®šä¹‰ç»„åˆ |

## ğŸš€ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰èƒ½åŠ›æ ‡ç­¾

å¯ä»¥é€šè¿‡ä¿®æ”¹ `agent-profiles.json` ä¸º agent æ·»åŠ è‡ªå®šä¹‰èƒ½åŠ›æ ‡ç­¾ï¼š

```json
{
  "agents": {
    "my-agent": {
      "tags": ["coding", "ml", "data"],
      "extraDescription": "ä¸“é—¨å¤„ç†æœºå™¨å­¦ä¹ å’Œæ•°æ®å¤„ç†ä»»åŠ¡"
    }
  }
}
```

### æ··åˆèƒ½åŠ› Agent

ç³»ç»Ÿä¼˜å…ˆé€‰æ‹©çº¯èƒ½åŠ› agentï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™ä½¿ç”¨æ··åˆèƒ½åŠ› agentï¼š

```
ä¼˜å…ˆçº§:
1. çº¯ coding agentï¼ˆåªæœ‰ coding æ ‡ç­¾ï¼‰
2. æ··åˆ agentï¼ˆæœ‰ coding + å…¶ä»–æ ‡ç­¾ï¼‰
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Agent Orchestrator ä¸»æ–‡æ¡£](./SKILL.md)
- [æ•°æ®æ¨¡å‹](./references/data-model.md)
- [Agent é…ç½®](/home/ubuntu/.openclaw/data/agent-orchestrator/agent-profiles.json)

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹åˆ†è§£ç»“æœ

```bash
# JSON æ ¼å¼è¾“å‡º
$AO decompose my-project --json

# æŸ¥çœ‹è¯†åˆ«çš„èƒ½åŠ›
$AO status my-project --json | jq '.routing'

# æŸ¥çœ‹ç”Ÿæˆçš„ä»»åŠ¡
$AO status my-project --json | jq '.plan.tasks'
```

### æµ‹è¯•åˆ†è§£é€»è¾‘

```python
from orchestrator import _extract_capabilities, _decompose_request

request = "ä½ çš„æµ‹è¯•è¯·æ±‚"
caps = _extract_capabilities(request)
tasks = _decompose_request(request)
print(f"è¯†åˆ«èƒ½åŠ›: {caps}")
for task in tasks:
    print(f"[{task['capability']}] {task['description']}")
```

---

**æœ€åæ›´æ–°**: 2026-02-15  
**ç‰ˆæœ¬**: 1.0  
**ç»´æŠ¤è€…**: Agent Orchestrator Team
